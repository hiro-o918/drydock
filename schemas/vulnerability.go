package schemas

// ============================================================================
// Core Domain Types
// ============================================================================

// Severity represents the severity level
type Severity string

const (
	SeverityUnspecified Severity = "UNSPECIFIED"
	SeverityMinimal     Severity = "MINIMAL"
	SeverityLow         Severity = "LOW"
	SeverityMedium      Severity = "MEDIUM"
	SeverityHigh        Severity = "HIGH"
	SeverityCritical    Severity = "CRITICAL"
)

// Vulnerability represents a single vulnerability finding
type Vulnerability struct {
	// ID is the CVE identifier
	ID string

	// Severity is the vulnerability severity level
	Severity Severity

	// PackageName is the affected package
	PackageName string

	// InstalledVersion is the currently installed version
	InstalledVersion string

	// FixedVersion is the version that fixes the vulnerability (if available)
	FixedVersion string

	// Description provides details about the vulnerability
	Description string

	// CVSSScore is the CVSS score
	CVSSScore float32

	// URLs contains reference links
	URLs []string
}

// VulnerabilitySummary provides aggregated statistics
type VulnerabilitySummary struct {
	// TotalCount is the total number of vulnerabilities
	TotalCount int

	// CountBySeverity maps severity levels to counts
	CountBySeverity map[Severity]int

	// FixableCount is the number of vulnerabilities with fixes available
	FixableCount int
}
