package schemas

// ============================================================================
// Core Domain Types
// ============================================================================

// Severity represents the severity level
type Severity string

const (
	SeverityUnspecified Severity = "UNSPECIFIED"
	SeverityMinimal     Severity = "MINIMAL"
	SeverityLow         Severity = "LOW"
	SeverityMedium      Severity = "MEDIUM"
	SeverityHigh        Severity = "HIGH"
	SeverityCritical    Severity = "CRITICAL"
)

// Vulnerability represents a single vulnerability finding
type Vulnerability struct {
	// ID is the CVE identifier
	ID string `json:"id" yaml:"id"`

	// Severity is the vulnerability severity level
	Severity Severity `json:"severity" yaml:"severity"`

	// PackageName is the affected package
	PackageName string `json:"packageName" yaml:"packageName"`

	// InstalledVersion is the currently installed version
	InstalledVersion string `json:"installedVersion" yaml:"installedVersion"`

	// FixedVersion is the version that fixes the vulnerability (if available)
	FixedVersion string `json:"fixedVersion,omitempty" yaml:"fixedVersion,omitempty"`

	// PackageType indicates the type/category of the vulnerability
	PackageType string `json:"packageType" yaml:"packageType"`

	// Description provides details about the vulnerability
	Description string `json:"description" yaml:"description"`

	// CVSSScore is the CVSS score
	CVSSScore float32 `json:"cvssScore" yaml:"cvssScore"`

	// URLs contains reference links
	URLs []string `json:"urls,omitempty" yaml:"urls,omitempty"`
}

// VulnerabilitySummary provides aggregated statistics
type VulnerabilitySummary struct {
	// TotalCount is the total number of vulnerabilities
	TotalCount int `json:"totalCount" yaml:"totalCount"`

	// CountBySeverity maps severity levels to counts
	CountBySeverity map[Severity]int `json:"countBySeverity" yaml:"countBySeverity"`

	// FixableCount is the number of vulnerabilities with fixes available
	FixableCount int `json:"fixableCount" yaml:"fixableCount"`
}
